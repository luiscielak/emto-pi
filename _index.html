<!DOCTYPE HTML>
<html>
<head>
  <style>
    body { margin: 0px; padding: 0px; }
    canvas { border: 1px solid #9C9898; }
  </style>
  <script src="../js/lib/kinetic-v5.0.1.min.js"></script>
  <script>

    var socket = new WebSocket("ws://coder.local:9999/ws");

    socket.onopen = function(){
      console.log("connected");
    };

    socket.onmessage = function (message) {
      console.log("receiving: " + message.data);
    };

    socket.onclose = function(){
      console.log("disconnected");
    };

    sendMessage = function(message) {
      socket.send(message);
    };

    var value = 0;

    window.onload = function() {
      var stage = new Kinetic.Stage({
        container: "container",
        width: 1000,
        height: 1000
      });

      var layer  = new Kinetic.Layer();

      var circle = new Kinetic.Circle({
        x: 100,
        y: 100,
        radius: 170,
        fill: "red",
        stroke: "black",
        strokeWidth: 4,
        draggable: true
      });

      <!-- circle.on("mousedown", function() {  -->
        circle.on("touchstart", function() {
          value = value + 20;
          console.log('sending: ' + value);
          sendMessage("{value:" + value + "}");
        });

        layer.add(circle);
        stage.add(layer);
      };

    </script>
  </head>
  <body>
    <div id="container"></div>
  </body>
  </html>
